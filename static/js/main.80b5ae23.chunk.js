(this["webpackJsonpshc-web-verifier"]=this["webpackJsonpshc-web-verifier"]||[]).push([[0],{47:function(e,t,n){},48:function(e,t,n){},73:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),i=n(31),c=n.n(i),s=(n(47),n(10)),o=(n(48),n(40)),d=n(32),l=n.n(d),u=n(33),h=n(9),m=n.n(h),j=n(19),f=n(90),p=n(93),b=n(96),x=n(94),g=n(95),O=n(20),v=n(34),y=n.n(v),E=n.p+"static/media/iisstandards_tradename.ca620fff.xml",C=n.p+"static/media/iisstandards_cvx.f9c3cb7c.xml",N=n(2),B=Object(f.a)({bold:{fontWeight:"bold"}}),w=function(e){var t=e.patientData,n=B(),i=Object(r.useState)({}),c=Object(s.a)(i,2),o=c[0],d=c[1],l=Object(r.useState)({}),u=Object(s.a)(l,2),h=u[0],f=u[1];function v(e){return w.apply(this,arguments)}function w(){return(w=Object(j.a)(m.a.mark((function e(t){var n,r,a,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.get(t,{Accept:"application/xml"});case 2:return n=e.sent,e.next=5,n.data;case 5:if(r=(r=e.sent).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),a=new DOMParser,!((i=a.parseFromString(r,"application/xml")).getElementsByTagName("parsererror").length>0)){e.next=11;break}throw new Error("Error parsing XML");case 11:return e.abrupt("return",i);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}a.a.useEffect((function(){function e(){return(e=Object(j.a)(m.a.mark((function e(){var t,n,r,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(E);case 2:for(t=e.sent,n=t.evaluate("//productnames/prodInfo",t,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),r=n.iterateNext(),a={};r;)a[r.children[5].textContent.trim()]?a[r.children[5].textContent.trim()]=r.children[3].textContent:a[r.children[5].textContent.trim()]=r.children[1].textContent,r=n.iterateNext();d(a);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function t(){return(t=Object(j.a)(m.a.mark((function e(){var t,n,r,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(C);case 2:for(t=e.sent,n=t.evaluate("//CVXCodes/CVXInfo",t,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),r=n.iterateNext(),a={};r;)a[r.getElementsByTagName("CVXCode")[0].textContent.trim()]=r.getElementsByTagName("ShortDescription")[0].textContent,r=n.iterateNext();f(a);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),function(){t.apply(this,arguments)}()}),[]);var I=function(e){if(0===e.length)return"";var t=e[0];return o[t.code]?o[t.code]:h[t.code]?h[t.code]:t.system?"".concat(t.system,"#").concat(t.code):t.code};return Object(N.jsxs)("div",{children:[Object(N.jsxs)(O.a,{gutterBottom:!0,children:[Object(N.jsx)("span",{className:n.bold,children:"Name: "}),Object(N.jsx)("span",{children:t.name})]}),Object(N.jsxs)(O.a,{gutterBottom:!0,children:[Object(N.jsx)("span",{className:n.bold,children:"Date of Birth: "}),Object(N.jsx)("span",{children:t.dateOfBirth})]}),Object(N.jsx)(O.a,{variant:"h4",children:" Immunizations "}),Object(N.jsx)(p.a,{container:!0,spacing:2,direction:"row",justifyContent:"flex-start",alignItems:"flex-start",children:t.immunizations.map((function(e){return function(e){var t=e.fullUrl,r=e.resource;return Object(N.jsx)(p.a,{item:!0,children:Object(N.jsxs)(b.a,{variant:"outlined",children:[Object(N.jsx)(x.a,{title:r.vaccineCode?I(r.vaccineCode.coding):"",classes:{title:n.bold}}),Object(N.jsxs)(g.a,{children:[Object(N.jsxs)(O.a,{gutterBottom:!0,children:[Object(N.jsx)("span",{className:n.bold,children:"Date: "}),Object(N.jsx)("span",{children:r.occurrenceDateTime})]}),r.lotNumber&&Object(N.jsxs)(O.a,{gutterBottom:!0,children:[Object(N.jsx)("span",{className:n.bold,children:"Lot: "}),Object(N.jsx)("span",{children:r.lotNumber})]}),r.performer&&r.performer.length>0&&Object(N.jsxs)(O.a,{gutterBottom:!0,children:[Object(N.jsx)("span",{className:n.bold,children:"Performer: "}),Object(N.jsx)("span",{children:r.performer[0].actor.display})]})]})]})},t)}(e)}))})]})};var I=function(){var e=Object(r.useState)(!1),t=Object(s.a)(e,2),n=t[0],a=t[1],i=Object(r.useState)(null),c=Object(s.a)(i,2),d=c[0],h=c[1],m=function(){var e=document.getElementById("video");e.srcObject.getTracks().forEach((function(e){return e.stop()})),e.remove(),document.getElementById("canvas").hidden=!0,document.getElementById("loadingMessage").hidden=!0,a(!1)};function j(){var e=document.getElementById("video");if(e){if(e.readyState===e.HAVE_ENOUGH_DATA){var t=document.getElementById("canvas"),n=t.getContext("2d"),r=document.getElementById("loadingMessage"),a=document.getElementById("statusMessage");r.hidden=!0,t.hidden=!1,t.height=e.videoHeight,t.width=e.videoWidth,n.drawImage(e,0,0,t.width,t.height);var i=n.getImageData(0,0,t.width,t.height),c=l()(i.data,i.width,i.height,{inversionAttempts:"dontInvert"});if(c)if(c.data.startsWith("shc:/")){m();var s=function(e){var t=JSON.parse(e).vc.credentialSubject.fhirBundle,n=t.entry.find((function(e){return"Patient"===e.resource.resourceType})).resource;return{name:function(e){var t=e.name[0];return t.text?t.text:[t.prefix?t.prefix.join(" "):"",t.given?t.given.join(" "):"",t.family?t.family:"",t.suffix?t.suffix.join(" "):""].join(" ").trim()}(n),dateOfBirth:n.birthDate,immunizations:function(e){return e.entry.filter((function(e){return"Immunization"===e.resource.resourceType}))}(t)}}(function(e){var t=e.lastIndexOf("/"),n=e.slice(t+1).match(/\d\d/g).map((function(e){return String.fromCharCode(+e+45)})).join("").split(".")[1],r=o.a.toUint8Array(n),a=u.a.inflateRaw(r);return(new TextDecoder).decode(a)}(c.data));h(s)}else a.innerText="QR code does not contain a SMART Health Card";else a.innerText="No QR code detected"}requestAnimationFrame(j)}}var f=Object(N.jsx)("button",{type:"button",id:"start",onClick:function(){a(!0),h(null);var e=document.createElement("video"),t=document.getElementById("loadingMessage");e.id="video",e.hidden=!0,document.children[0].appendChild(e),t.hidden=!1,navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}).then((function(t){e.srcObject=t,e.setAttribute("playsinline",!0),e.play().catch((function(){})),requestAnimationFrame(j)}))},disabled:n,children:"Scan"}),p=Object(N.jsx)("button",{type:"button",id:"stop",onClick:m,disabled:!n,children:"Stop"});return Object(N.jsxs)("div",{className:"App",children:[Object(N.jsx)("header",{className:"App-header",children:Object(N.jsx)("h1",{children:"SMART Health Cards Web Verifier"})}),Object(N.jsxs)("div",{children:[f,p]}),Object(N.jsx)("div",{id:"loadingMessage",hidden:!0,children:"Loading..."}),Object(N.jsx)("canvas",{id:"canvas",hidden:!n}),Object(N.jsx)("div",{id:"statusMessage",hidden:!n,children:"No QR code detected."}),d&&!n?Object(N.jsx)(w,{patientData:d}):""]})},T=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,98)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),i(e),c(e)}))};c.a.render(Object(N.jsx)(a.a.StrictMode,{children:Object(N.jsx)(I,{})}),document.getElementById("root")),T()}},[[73,1,2]]]);
//# sourceMappingURL=main.80b5ae23.chunk.js.map